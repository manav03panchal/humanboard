<!-- Source: https://deepwiki.com/zed-industries/zed/4.4-search-system -->

# 4.4 Search System

Loading...

Index your code with Devin

[DeepWiki](</>)

[DeepWiki](</>)

[zed-industries/zed ](<https://github.com/zed-industries/zed> "Open repository")

Index your code with

Devin

Edit WikiShare

Loading...

Last indexed: 16 December 2025 ([4109c9](<https://github.com/zed-industries/zed/commits/4109c9dd>))

  * [Overview](</zed-industries/zed/1-overview>)
  * [Core Architecture](</zed-industries/zed/2-core-architecture>)
  * [Application Initialization and Lifecycle](</zed-industries/zed/2.1-application-initialization-and-lifecycle>)
  * [GPUI Framework](</zed-industries/zed/2.2-gpui-framework>)
  * [Window and Platform Abstraction](</zed-industries/zed/2.3-window-and-platform-abstraction>)
  * [Event Flow and Input Handling](</zed-industries/zed/2.4-event-flow-and-input-handling>)
  * [Keybinding and Action System](</zed-industries/zed/2.5-keybinding-and-action-system>)
  * [Focus Management and Hit Testing](</zed-industries/zed/2.6-focus-management-and-hit-testing>)
  * [Editor Architecture](</zed-industries/zed/3-editor-architecture>)
  * [Editor Component and UI](</zed-industries/zed/3.1-editor-component-and-ui>)
  * [Buffer System and Text Storage](</zed-industries/zed/3.2-buffer-system-and-text-storage>)
  * [Display Pipeline and Rendering](</zed-industries/zed/3.3-display-pipeline-and-rendering>)
  * [Selections and Editing Operations](</zed-industries/zed/3.4-selections-and-editing-operations>)
  * [Code Intelligence Integration](</zed-industries/zed/3.5-code-intelligence-integration>)
  * [Diff Integration](</zed-industries/zed/3.6-diff-integration>)
  * [Workspace and Panel System](</zed-industries/zed/4-workspace-and-panel-system>)
  * [Workspace Organization](</zed-industries/zed/4.1-workspace-organization>)
  * [Item System and Lifecycle](</zed-industries/zed/4.2-item-system-and-lifecycle>)
  * [Pane Management](</zed-industries/zed/4.3-pane-management>)
  * [Search System](</zed-industries/zed/4.4-search-system>)
  * [Project Management](</zed-industries/zed/5-project-management>)
  * [Project Orchestration](</zed-industries/zed/5.1-project-orchestration>)
  * [Worktree and File System](</zed-industries/zed/5.2-worktree-and-file-system>)
  * [Buffer Store](</zed-industries/zed/5.3-buffer-store>)
  * [Language Intelligence](</zed-industries/zed/6-language-intelligence>)
  * [LSP Store Architecture](</zed-industries/zed/6.1-lsp-store-architecture>)
  * [Language Server Lifecycle](</zed-industries/zed/6.2-language-server-lifecycle>)
  * [Completions and Diagnostics](</zed-industries/zed/6.3-completions-and-diagnostics>)
  * [Multi-Language Server Coordination](</zed-industries/zed/6.4-multi-language-server-coordination>)
  * [Settings and Configuration](</zed-industries/zed/7-settings-and-configuration>)
  * [Settings Store and Layering](</zed-industries/zed/7.1-settings-store-and-layering>)
  * [Settings UI](</zed-industries/zed/7.2-settings-ui>)
  * [Settings Migration](</zed-industries/zed/7.3-settings-migration>)
  * [Keymap System](</zed-industries/zed/7.4-keymap-system>)
  * [Git Integration](</zed-industries/zed/8-git-integration>)
  * [Git Panel and UI](</zed-industries/zed/8.1-git-panel-and-ui>)
  * [Git Store and State Management](</zed-industries/zed/8.2-git-store-and-state-management>)
  * [Repository Operations](</zed-industries/zed/8.3-repository-operations>)
  * [Diff System](</zed-industries/zed/8.4-diff-system>)
  * [Terminal and Task Execution](</zed-industries/zed/9-terminal-and-task-execution>)
  * [Terminal Core](</zed-industries/zed/9.1-terminal-core>)
  * [Terminal View and Rendering](</zed-industries/zed/9.2-terminal-view-and-rendering>)
  * [Task System](</zed-industries/zed/9.3-task-system>)
  * [Vim Mode](</zed-industries/zed/10-vim-mode>)
  * [Mode State Machine](</zed-industries/zed/10.1-mode-state-machine>)
  * [Operators, Motions, and Objects](</zed-industries/zed/10.2-operators-motions-and-objects>)
  * [Visual Mode](</zed-industries/zed/10.3-visual-mode>)
  * [Helix Mode Integration](</zed-industries/zed/10.4-helix-mode-integration>)
  * [AI Agent System](</zed-industries/zed/11-ai-agent-system>)
  * [Agent Communication Protocol (ACP)](</zed-industries/zed/11.1-agent-communication-protocol-\(acp\)>)
  * [Agent UI and Thread Management](</zed-industries/zed/11.2-agent-ui-and-thread-management>)
  * [Agent Connection and Implementations](</zed-industries/zed/11.3-agent-connection-and-implementations>)
  * [Tool System](</zed-industries/zed/11.4-tool-system>)
  * [Mention System and Context](</zed-industries/zed/11.5-mention-system-and-context>)
  * [Legacy Agent Thread System](</zed-industries/zed/11.6-legacy-agent-thread-system>)
  * [Remote Development and Collaboration](</zed-industries/zed/12-remote-development-and-collaboration>)
  * [Local vs Remote Architecture](</zed-industries/zed/12.1-local-vs-remote-architecture>)
  * [Remote Project Architecture](</zed-industries/zed/12.2-remote-project-architecture>)
  * [Collaboration Features](</zed-industries/zed/12.3-collaboration-features>)
  * [CRDT and Synchronization](</zed-industries/zed/12.4-crdt-and-synchronization>)


Menu

# Search System

Relevant source files

  * [crates/editor/src/items.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/editor/src/items.rs>)
  * [crates/language/src/proto.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/language/src/proto.rs>)
  * [crates/project/src/search.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/project/src/search.rs>)
  * [crates/proto/proto/buffer.proto](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/proto/proto/buffer.proto>)
  * [crates/search/src/buffer_search.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/buffer_search.rs>)
  * [crates/search/src/project_search.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs>)
  * [crates/vim/src/normal/search.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/vim/src/normal/search.rs>)
  * [crates/workspace/src/item.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/item.rs>)
  * [crates/workspace/src/pane.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/pane.rs>)
  * [crates/workspace/src/searchable.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/searchable.rs>)
  * [crates/workspace/src/workspace.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/workspace.rs>)


## Overview

The Search System provides comprehensive search functionality in Zed, supporting both **buffer-level search** (find/replace within a single file) and **project-wide search** (find across all files in a workspace). The system is built on a trait-based architecture that allows any item type to be searchable, with specialized implementations for text editors.

For information about navigating search results in the editor, see [3.1 Editor Component and UI](</zed-industries/zed/3.1-editor-component-and-ui>). For workspace-level item management, see [4.1 Workspace Organization](</zed-industries/zed/4.1-workspace-organization>).

**Key capabilities:**

  * Buffer search with find/replace
  * Project-wide search with multi-file results
  * Regular expression support
  * Case-sensitive and whole-word matching
  * File inclusion/exclusion patterns
  * Search history management
  * Vim mode integration


* * *

## Architecture Overview

The search system is organized into multiple layers, from UI components down to core search execution logic.


**Sources:** [crates/search/src/buffer_search.rs98-127](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/buffer_search.rs#L98-L127>) [crates/search/src/project_search.rs197-250](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L197-L250>) [crates/workspace/src/searchable.rs58-170](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/searchable.rs#L58-L170>)

* * *

## Core Abstractions

### SearchableItem Trait

The `SearchableItem` trait defines the interface that any item must implement to support search functionality. It is generic over a `Match` type that represents a single search result.


**Key methods:**

Method| Purpose  
---|---  
`find_matches()`| Executes search and returns matches asynchronously  
`clear_matches()`| Removes all search highlighting  
`update_matches()`| Updates UI with new match set  
`activate_match()`| Navigates to and selects a specific match  
`select_matches()`| Selects all provided matches  
`replace()`| Replaces a single match  
`replace_all()`| Replaces all matches  
`query_suggestion()`| Provides default query text (e.g., selected text)  
`active_match_index()`| Returns currently active match index  
  
**Sources:** [crates/workspace/src/searchable.rs58-170](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/searchable.rs#L58-L170>)

### SearchOptions

`SearchOptions` describes which search features a `SearchableItem` supports:


**Sources:** [crates/workspace/src/searchable.rs37-46](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/searchable.rs#L37-L46>)

### SearchQuery

The `SearchQuery` enum represents a compiled search query, supporting both text and regex searches:


**Key methods:**

Method| Purpose  
---|---  
`text()`| Creates a text search query (uses Aho-Corasick algorithm)  
`regex()`| Creates a regex search query  
`with_replacement()`| Adds replacement text to query  
`detect()`| Checks if query matches in a file stream  
`search()`| Finds all matches in a buffer snapshot  
`replacement_for()`| Generates replacement text for a match  
  
**Sources:** [crates/project/src/search.rs60-327](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/project/src/search.rs#L60-L327>)

* * *

## Buffer Search System

Buffer search operates on a single `Editor` instance, providing find/replace functionality within one file.

### Component Architecture


**Sources:** [crates/search/src/buffer_search.rs103-127](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/buffer_search.rs#L103-L127>)

### Buffer Search Flow


**Sources:** [crates/search/src/buffer_search.rs674-767](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/buffer_search.rs#L674-L767>) [crates/editor/src/editor.rs7729-7838](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/editor/src/editor.rs#L7729-L7838>)

### Key Actions

Buffer search responds to the following actions:

Action| Description  
---|---  
`Deploy`| Opens search bar with optional focus and replace mode  
`FocusSearch`| Focuses the search query input  
`SelectNextMatch`| Moves to next match  
`SelectPreviousMatch`| Moves to previous match  
`SelectAllMatches`| Selects all matches  
`ReplaceNext`| Replaces current match and moves to next  
`ReplaceAll`| Replaces all matches  
`ToggleCaseSensitive`| Toggles case-sensitive flag  
`ToggleWholeWord`| Toggles whole-word matching  
`ToggleRegex`| Toggles regex mode  
`ToggleReplace`| Shows/hides replace input  
  
**Sources:** [crates/search/src/buffer_search.rs52-74](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/buffer_search.rs#L52-L74>) [crates/search/src/mod.rs19-60](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/mod.rs#L19-L60>)

* * *

## Project Search System

Project search enables searching across all files in a workspace, with results displayed in a multi-buffer view.

### Component Architecture


**Sources:** [crates/search/src/project_search.rs220-270](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L220-L270>) [crates/search/src/project_search.rs252-270](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L252-L270>)

### Project Search Flow


**Sources:** [crates/search/src/project_search.rs305-407](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L305-L407>) [crates/project/src/project.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/project/src/project.rs>)

### Search Result Display

Project search results are displayed in a `MultiBuffer`, which aggregates excerpts from multiple files:


Each excerpt includes:

  * **Primary range** : The lines containing matches
  * **Context range** : Additional lines before/after for context (configurable via `multibuffer_context_lines()`)
  * **Anchors** : Position tracking that survives edits


**Sources:** [crates/search/src/project_search.rs363-379](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L363-L379>) [crates/editor/src/multibuffer.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/editor/src/multibuffer.rs>)

### File Filtering

Project search supports including/excluding files via glob patterns:


**Pattern syntax:**

  * `*` \- Matches any characters except `/`
  * `**` \- Matches any characters including `/`
  * `?` \- Matches a single character
  * `[abc]` \- Matches any character in brackets
  * `{a,b}` \- Matches any of the comma-separated patterns


**Sources:** [crates/project/src/search.rs38-59](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/project/src/search.rs#L38-L59>) [crates/util/src/paths.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/util/src/paths.rs>)

* * *

## Search Actions and Settings

### Project Search Actions

Action| Description  
---|---  
`NewSearch`| Opens a new project search tab  
`DeploySearch`| Activates search bar with options  
`SearchInNew`| Duplicates current search in new tab  
`ToggleFocus`| Switches focus between search bar and results  
`ToggleFilters`| Shows/hides file filter inputs  
`ToggleReplace`| Enables/disables replace mode  
`ToggleAllSearchResults`| Collapses/expands all result excerpts  
`ReplaceNext`| Replaces next occurrence  
`ReplaceAll`| Replaces all occurrences across files  
  
**Sources:** [crates/search/src/project_search.rs49-63](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L49-L63>) [crates/workspace/src/workspace.rs195-287](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/workspace.rs#L195-L287>)

### Settings

Project search stores per-project settings in `ActiveSettings`:


Settings persist across workspace sessions and are stored in `~/.config/zed/settings.json`.

**Sources:** [crates/search/src/project_search.rs241-245](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L241-L245>) [crates/search/src/project_search.rs65-68](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L65-L68>)

* * *

## Search History

Both buffer and project search maintain search history for quick access to previous queries.


**History operations:**

  * **Add** : `search_history.add(&mut cursor, query)` \- Adds query to history
  * **Previous** : `cursor.prev(&search_history)` \- Moves to older query
  * **Next** : `cursor.next(&search_history)` \- Moves to newer query
  * **Reset** : `cursor.reset()` \- Returns to end of history


History is limited to `MAX_BUFFER_SEARCH_HISTORY_SIZE` (50) entries per category.

**Sources:** [crates/search/src/buffer_search.rs49](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/buffer_search.rs#L49-L49>) [crates/project/src/search_history.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/project/src/search_history.rs>)

* * *

## Editor Search Implementation

The `Editor` implements `SearchableItem` to provide buffer-level search:


**Key implementation details:**

  1. **find_matches()** : Delegates to `buffer.read().search(query)` which uses `SearchQuery::search()` to scan buffer text
  2. **activate_match()** : Updates selections to highlight the match and scrolls it into view
  3. **select_matches()** : Converts all matches to multi-cursor selections
  4. **replace()** : Edits the buffer to replace match text with replacement
  5. **replace_all()** : Batches all replacements into a single transaction


The editor highlights matches using `HighlightKey::SearchMatch` and `HighlightKey::SearchMatchActive` for different visual emphasis.

**Sources:** [crates/editor/src/editor.rs7729-7990](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/editor/src/editor.rs#L7729-L7990>)

* * *

## Vim Mode Integration

Vim mode integrates with the search system through custom search commands and motions.

### Vim Search Flow


**Sources:** [crates/vim/src/normal/search.rs152-203](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/vim/src/normal/search.rs#L152-L203>) [crates/vim/src/normal/search.rs214-287](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/vim/src/normal/search.rs#L214-L287>)

### Vim Search Commands

Command| Action| Description  
---|---|---  
`/`| `Search{backwards: false}`| Forward search  
`?`| `Search{backwards: true}`| Backward search  
`n`| `MoveToNextMatch`| Repeat last search forward  
`N`| `MoveToPreviousMatch`| Repeat last search backward  
`*`| `MoveToNext{case_sensitive: true, partial_word: false}`| Search word under cursor forward  
`#`| `MoveToPrevious{case_sensitive: true, partial_word: false}`| Search word under cursor backward  
`:%s/pattern/replacement/`| `ReplaceCommand`| Replace in range  
  
**Vim-specific features:**

  * Stores search state including `prior_selections` and `prior_mode`
  * Integrates search with operators (e.g., `d/pattern` deletes to next match)
  * Supports count prefixes (e.g., `3n` jumps to 3rd next match)
  * Handles visual mode selection during search


**Sources:** [crates/vim/src/normal/search.rs95-104](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/vim/src/normal/search.rs#L95-L104>) [crates/vim/src/command.rs](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/vim/src/command.rs>)

* * *

## Advanced Features

### Search in Results

Project search supports "find in results" mode, which narrows down an existing search:


This is implemented by treating the results editor as a searchable item itself.

**Sources:** [crates/search/src/buffer_search.rs145-151](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/buffer_search.rs#L145-L151>)

### Search Within Selection

Buffer search can be restricted to the current selection:


When enabled, `Editor::find_matches()` receives a `subrange` parameter limiting the search scope.

**Sources:** [crates/workspace/src/searchable.rs51-56](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/workspace/src/searchable.rs#L51-L56>) [crates/editor/src/editor.rs7751-7753](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/editor/src/editor.rs#L7751-L7753>)

### Multi-Language Regex Support

The search system uses `fancy_regex` for full regex support including:

  * Lookahead/lookbehind assertions
  * Backreferences
  * Non-greedy quantifiers
  * Unicode property escapes


Replacement strings support special escape sequences:

  * `\\` → `\`
  * `\n` → newline
  * `\t` → tab
  * `$1`, `$2`, etc. → capture groups


**Sources:** [crates/project/src/search.rs183-186](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/project/src/search.rs#L183-L186>) [crates/project/src/search.rs384-395](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/project/src/search.rs#L384-L395>)

* * *

## Data Flow Summary


**Sources:** [crates/project/src/search.rs88-293](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/project/src/search.rs#L88-L293>) [crates/search/src/project_search.rs305-407](<https://github.com/zed-industries/zed/blob/4109c9dd/crates/search/src/project_search.rs#L305-L407>)

Dismiss

Refresh this wiki

This wiki was recently refreshed. Please wait 7 days to refresh again.

### On this page

  * [Search System](<#search-system>)
  * [Overview](<#overview>)
  * [Architecture Overview](<#architecture-overview>)
  * [Core Abstractions](<#core-abstractions>)
  * [SearchableItem Trait](<#searchableitem-trait>)
  * [SearchOptions](<#searchoptions>)
  * [SearchQuery](<#searchquery>)
  * [Buffer Search System](<#buffer-search-system>)
  * [Component Architecture](<#component-architecture>)
  * [Buffer Search Flow](<#buffer-search-flow>)
  * [Key Actions](<#key-actions>)
  * [Project Search System](<#project-search-system>)
  * [Component Architecture](<#component-architecture-1>)
  * [Project Search Flow](<#project-search-flow>)
  * [Search Result Display](<#search-result-display>)
  * [File Filtering](<#file-filtering>)
  * [Search Actions and Settings](<#search-actions-and-settings>)
  * [Project Search Actions](<#project-search-actions>)
  * [Settings](<#settings>)
  * [Search History](<#search-history>)
  * [Editor Search Implementation](<#editor-search-implementation>)
  * [Vim Mode Integration](<#vim-mode-integration>)
  * [Vim Search Flow](<#vim-search-flow>)
  * [Vim Search Commands](<#vim-search-commands>)
  * [Advanced Features](<#advanced-features>)
  * [Search in Results](<#search-in-results>)
  * [Search Within Selection](<#search-within-selection>)
  * [Multi-Language Regex Support](<#multi-language-regex-support>)
  * [Data Flow Summary](<#data-flow-summary>)
